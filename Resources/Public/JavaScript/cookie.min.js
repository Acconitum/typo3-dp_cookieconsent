/*!
  * Cookie Consent Adapter
  * Copyright 2018 Dirk Persky (https://github.com/DirkPersky/typo3-dp_cookieconsent)
  * Licensed under GPL v3+ (https://github.com/DirkPersky/typo3-dp_cookieconsent/blob/master/LICENSE)
  */
window.addEventListener("load",function(){function e(){this.cookie_name="dp_cookieconsent_status",this.cookie={path:"/",domain:"",expiryDays:365,secure:!1}}e.prototype.asyncLoad=function(e,o,t){var i=document,s=i.createElement(o),n=i.getElementsByTagName(o)[0];switch(o){case"script":s.src=e,s.setAttribute("defer","");break;case"link":s.rel="stylesheet",s.type="text/css",s.setAttribute("defer",""),s.href=e}t&&s.addEventListener("load",function(e){t(null,e)},!1),n.parentNode.insertBefore(s,n)},e.prototype.asyncJS=function(e,o){this.asyncLoad(e,"script",o)},e.prototype.asyncCSS=function(e){this.asyncLoad(e,"link")},e.prototype.getCookieElementsByTag=function(e){var o=[];if(void 0===document.querySelectorAll)o=document.querySelectorAll(e+"[data-cookieconsent]");else{var t=document.getElementsByTagName(e);for(var i in t){var s=t[i];void 0!==s.getAttribute&&s.getAttribute("data-cookieconsent")&&o.push(s)}}return o},e.prototype.callIframeHandler=function(e){var o=e.cloneNode(!0);o.getAttribute("data-src")&&(o.src=o.getAttribute("data-src")),e.parentNode.replaceChild(o,e),o.classList.add("dp--loaded")},e.prototype.callScriptHandler=function(e){var o=e.innerHTML;o&&o.length&&(o=o.trim()),o&&o.length?eval.call(this,o):e.getAttribute("data-src")?this.asyncJS(e.getAttribute("data-src")):e.src&&this.asyncJS(e.src)},e.prototype.loadCookies=function(){var e,o=this.getCookieElementsByTag("script");if((o=o.concat(this.getCookieElementsByTag("iframe"))).length>0)for(e=0;e<o.length;e++){if("dpextend"===window.cookieconsent_options.layout){var t=o[e].dataset.cookieconsent;if("required"!=t&&(this.loadCookiesPreset(),!this.dpCookies.hasOwnProperty("dp--cookie-"+t)||!0!==this.dpCookies["dp--cookie-"+t]))continue}if(void 0!==o[e].tagName)switch(o[e].tagName.toUpperCase()){case"IFRAME":this.callIframeHandler(o[e]);break;default:this.callScriptHandler(o[e])}}},e.prototype.load=function(){this.asyncCSS(window.cookieconsent_options.css),"dpextend"==window.cookieconsent_options.layout&&this.asyncCSS(window.cookieconsent_options.dpCSS),this.asyncJS(window.cookieconsent_options.js,this.init)},e.prototype.setClass=function(e){!0===e?document.querySelector("body").classList.remove("dp--cookie-consent"):document.querySelector("body").classList.add("dp--cookie-consent")},e.prototype.setCheckboxes=function(){if("dpextend"==window.cookieconsent_options.layout){var e=this.loadCheckbox("dp--cookie-statistics"),o=this.loadCheckbox("dp--cookie-marketing");this.saveCookie([e,o])}},e.prototype.loadCheckboxes=function(){if("dpextend"==window.cookieconsent_options.layout){this.loadCookiesPreset();this.loadCheckbox("dp--cookie-statistics",!0),this.loadCheckbox("dp--cookie-marketing",!0)}},e.prototype.saveCookie=function(e){var o={};e.map(function(e){o[e.id]=e.checked}),window.cookieconsent.utils.setCookie(this.cookie_name,JSON.stringify(o),this.cookie.expiryDays,this.cookie.domain,this.cookie.path,this.cookie.secure)},e.prototype.loadCookiesPreset=function(){if(0!=this.dpCookies&&(this.dpCookies=window.cookieconsent.utils.getCookie(this.cookie_name)),void 0!==this.dpCookies)try{this.dpCookies=JSON.parse(this.dpCookies)}catch(e){this.dpCookies=!1}else this.dpCookies=!1},e.prototype.loadCheckbox=function(e,o){var t=document.getElementById(e);return!0===o&&this.dpCookies&&this.dpCookies.hasOwnProperty(e)&&(t.checked=this.dpCookies[e]),t},e.prototype.init=function(){window.cookieconsent.initialise({content:window.cookieconsent_options.content,theme:window.cookieconsent_options.theme,position:window.cookieconsent_options.position,palette:window.cookieconsent_options.palette,dismissOnScroll:window.cookieconsent_options.dismissOnScroll,type:window.cookieconsent_options.type,layout:window.cookieconsent_options.layout,revokable:window.cookieconsent_options.revokable,cookie:(new e).cookie,layouts:{dpextend:"{{dpmessagelink}}{{compliance}}"},elements:{dpmessagelink:'<span id="cookieconsent:desc" class="cc-message">{{message}} <a aria-label="learn more about cookies" role=button tabindex="0" class="cc-link" href="{{href}}" rel="noopener noreferrer nofollow" target="{{target}}">{{link}}</a><div class="dp--cookie-check"><label for="dp--cookie-require"><input type="checkbox" id="dp--cookie-require" class="dp--check-box" disabled="disabled" checked="checked"> {{dpRequire}}</label><label for="dp--cookie-statistics"><input type="checkbox" id="dp--cookie-statistics" class="dp--check-box" '+(window.cookieconsent_options.checkboxes.statistics?'checked="checked"':"")+'> {{dpStatistik}}</label><label for="dp--cookie-marketing"><input type="checkbox" id="dp--cookie-marketing" class="dp--check-box" '+(window.cookieconsent_options.checkboxes.marketing?'checked="checked"':"")+"> {{dpMarketing}}</label></div></span>"},onPopupOpen:function(){(new e).setClass(),(new e).loadCheckboxes()},onPopupClose:function(){(new e).setClass(!0)},onInitialise:function(o){!this.hasConsented()||"dismiss"!=o&&"allow"!=o||(new e).loadCookies()},onStatusChange:function(o){(new e).setCheckboxes(),!this.hasConsented()||"dismiss"!=o&&"allow"!=o||(new e).loadCookies()},onRevokeChoice:function(){}})},(new e).load()});
